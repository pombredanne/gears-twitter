<!DOCTYPE html>
<html class="fuelux">
<head>
	<title></title>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
	<script src="//fuelcdn.com/fuelux-imh/2.2/loader.min.js"></script>
	<link href="//fuelcdn.com/fuelux-imh/2.2/css/fuelux.css" rel="stylesheet" />
	<style type="text/css">
		body {
			background-color: #f3f3f3 !important;
		}
		.thumbnail {
			float:left;
			margin: 3px;
			background-color: #fff;
		}
		.thumbnail .inner {
			width: 100px;
			height: 100px;

			filter: alpha(opacity=60);
			opacity: .60;
		}
		.thumbnail-active .inner {
			filter: alpha(opacity=100);
			opacity: 1;
		}
	</style>
	<script>
		$(function() {
			var url = 'http://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=d6d798f51bbd5ec0a1f9e9f1e62c43ab&format=json';
			var selectedImageUrl = '';

			$('#searchField').on('searched', function(event, searchText) {
				console.log('searching', searchText);
				var options = {
					search: searchText,
					pageSize: 10,
					pageIndex: 1
				}

				findImage(options);
			});

			$('#searchField').on('cleared', function() {
				$('#output').html('');
			});

			$('body').on('click', '.thumbnail', function() {
				$('.thumbnail').removeClass('thumbnail-active');
				$(this).addClass('thumbnail-active');

				selectedImageUrl = $(this).data('url');
				console.log(selectedImageUrl);
			});

			function findImage(options) {
				// Search active.  Add URL parameters for Flickr API.
				url += '&tags=' + options.search;
				url += '&per_page=' + options.pageSize;
				url += '&page=' + (options.pageIndex + 1);

				$.ajax(url, {

					// Set JSONP options for Flickr API
					dataType: 'jsonp',
					jsonpCallback: 'jsonFlickrApi',
					jsonp: false,
					type: 'GET'

				}).done(function (response) {

					console.log(response);
					// Prepare data to return to Datagrid
					var data = response.photos.photo;
					var count = response.photos.total;
					var startIndex = (response.photos.page - 1) * response.photos.perpage;
					var endIndex = startIndex + response.photos.perpage;
					var end = (endIndex > count) ? count : endIndex;
					var pages = response.photos.pages;
					var page = response.photos.page;
					var start = startIndex + 1;

					// Allow client code to format the data
					//if (self._formatter) self._formatter(data);

					var html = '';
					for(var i=0; i<data.length; i++) {
						var image = data[i];
						var url = 'http://farm' + image.farm + '.staticflickr.com/' + image.server +  '/' + image.id + '_' + image.secret + '_t.jpg';
						html += '<div class="thumbnail" data-url="foo"><div class="inner" style="background:url(' + url + ') center center no-repeat;"></div></div>';
					}

					$('#output').html(html);

					// Return data to Datagrid
					//callback({ data: data, start: start, end: end, count: count, pages: pages, page: page });

				});
			}

		});
	</script>
	<style type="text/css">

	</style>
</head>
<body style="padding:20px;">

	<!--<div class="thumbnail"><div class="inner"></div></div>
	<div class="thumbnail"><div class="inner"></div></div>
	<div class="thumbnail"><div class="inner"></div></div>-->

	<div id="searchField" class="input-append search">
		<input type="text" class="input-medium" placeholder="Search"><button class="btn"><i class="icon-search"></i></button>
	</div>

	<div id="output" class="clearfix"></div>

	<div id="selected-img"></div>
</body>
</html>